SELECT
    ppat.name AS Project_Name,
    peia.expenditure_item_id AS TRANSACTION_IDG,
    gaap_data.GAAP_ACCOUNT AS GAAP_ACCOUNT,
    ferc_data.FERC_ACCOUNT AS FERC_ACCOUNT,
    gaap_data.GAAP_CREDIT AS GAAP_CREDIT,
    gaap_data.GAAP_DEBITS AS GAAP_DEBITS,
    ferc_data.FERC_CREDIT AS FERC_CREDIT,
    ferc_data.FERC_DEBITS AS FERC_DEBITS
FROM
    PJC_EXP_ITEMS_ALL peia,
    PJF_PROJECTS_ALL_B ppab,
    PJF_PROJECTS_ALL_TL ppat,
    xla_distribution_links XDA,
    xla_ae_lines XAL,
    gl_code_combinations gcc,
    GL_JE_LINES c,
    GL_JE_HEADERS B,
    GL_LEDGERS gll,
    (
        SELECT
            gcc.segment3 AS GAAP_ACCOUNT,
            c.accounted_cr AS GAAP_CREDIT,
            c.accounted_dr AS GAAP_DEBITS,
            XDA.event_id AS event_id,
            XDA.ae_line_num AS ae_line_num,
            XDA.source_distribution_id_num_1 AS TRANSACTION_IDG
        FROM
            xla_distribution_links XDA,
            xla_ae_lines XAL,
            gl_code_combinations gcc,
            GL_JE_LINES c,
            GL_JE_HEADERS B,
            GL_LEDGERS gll
        WHERE
            XDA.ae_header_id = XAL.ae_header_id (+)
            AND XDA.ae_line_num = XAL.ae_line_num (+)
            AND XAL.code_combination_id = gcc.code_combination_id (+)
            AND gcc.code_combination_id = c.code_combination_id (+)
            AND c.je_header_id = B.je_header_id (+)
            AND B.LEDGER_ID = gll.LEDGER_ID (+)
            AND B.name = '22-03-2024 Miscellaneous Cost'
            AND gll.name LIKE '%GAAP%'
    ) gaap_data,
    (
        SELECT
            gcc.segment3 AS FERC_ACCOUNT,
            c.accounted_cr AS FERC_CREDIT,
            c.accounted_dr AS FERC_DEBITS,
            XDA.event_id AS event_id,
            XDA.ae_line_num AS ae_line_num,
            XDA.source_distribution_id_num_1 AS TRANSACTION_IDG
        FROM
            xla_distribution_links XDA,
            xla_ae_lines XAL,
            gl_code_combinations gcc,
            GL_JE_LINES c,
            GL_JE_HEADERS B,
            GL_LEDGERS gll
        WHERE
            XDA.ae_header_id = XAL.ae_header_id (+)
            AND XDA.ae_line_num = XAL.ae_line_num (+)
            AND XAL.code_combination_id = gcc.code_combination_id (+)
            AND gcc.code_combination_id = c.code_combination_id (+)
            AND c.je_header_id = B.je_header_id (+)
            AND B.LEDGER_ID = gll.LEDGER_ID (+)
            AND B.name = '22-03-2024 Miscellaneous Cost'
            AND gll.name LIKE '%FERC%'
    ) ferc_data
WHERE
    peia.expenditure_item_id = ppab.project_id (+)
    AND ppab.project_id = ppat.project_id (+)
    AND peia.expenditure_item_id = XDA.source_distribution_id_num_1 (+)
    AND XDA.event_id = gaap_data.event_id (+)
    AND XDA.ae_line_num = gaap_data.ae_line_num (+)
    AND peia.expenditure_item_id = gaap_data.TRANSACTION_IDG (+)
    AND peia.expenditure_item_id = ferc_data.TRANSACTION_IDG (+)
    AND XDA.event_id = ferc_data.event_id (+)
    AND XDA.ae_line_num = ferc_data.ae_line_num (+);


_-------------
SELECT
            ppat.name AS Project_Name,
            PEIA.EXPENDITURE_ITEM_ID AS TRANSACTION_IDG,
            gcc.segment3 AS GAAP_ACCOUNT,
            ferc_data.FERC_ACCOUNT AS FERC_ACCOUNT,
            c.accounted_cr AS GAAP_CREDIT,
            c.accounted_dr AS GAAP_DEBITS,
            ferc_data.FERC_CREDIT AS FERC_CREDIT,
            ferc_data.FERC_DEBITS AS FERC_DEBITS 
        FROM
            PJC_EXP_ITEMS_ALL peia,
            PJC_COST_DIST_LINES_ALL PCDL,
            xla_distribution_links XDA,
            xla_ae_lines XAL,
            gl_code_combinations gcc,
            GL_JE_LINES c,
            GL_JE_HEADERS B,
            PJF_PROJECTS_ALL_B ppab,
            PJF_PROJECTS_ALL_TL ppat,
            GL_LEDGERS gll,
           ( SELECT
            ppat.name AS Project_Name,
            PEIA.EXPENDITURE_ITEM_ID AS TRANSACTION_IDG,
            gcc.segment3 AS FERC_ACCOUNT,
            c.accounted_cr AS FERC_CREDIT,
            c.accounted_dr AS FERC_DEBITS,
            xda.event_id as event_id,
            xda.ae_line_num as ae_line_num
        FROM
            PJC_EXP_ITEMS_ALL peia,
            PJC_COST_DIST_LINES_ALL PCDL,
            xla_distribution_links XDA,
            xla_ae_lines XAL,
            gl_code_combinations gcc,
            GL_JE_LINES c,
            GL_JE_HEADERS B,
            PJF_PROJECTS_ALL_B ppab,
            PJF_PROJECTS_ALL_TL ppat,
			GL_LEDGERS gll
        WHERE
            peia.expenditure_item_id = PCDL.expenditure_item_id (+)
            AND PCDL.expenditure_item_id = XDA.source_distribution_id_num_1(+)
            AND XDA.ae_header_id = XAL.ae_header_id (+)
            AND XDA.ae_line_num = XAL.ae_line_num (+)
            AND XAL.code_combination_id = gcc.code_combination_id (+)
            AND gcc.code_combination_id = c.code_combination_id (+)
            AND c.je_header_id = B.je_header_id (+)
            AND peia.project_id = ppab.project_id (+)
            AND ppab.project_id = ppat.project_id (+)
			AND B.LEDGER_ID = gll.LEDGER_ID (+)
            AND peia.expenditure_item_id = 31005
            AND B.name = '22-03-2024 Miscellaneous Cost'
            AND gll.name LIKE '%FERC%' )ferc_data
            
        WHERE
            peia.expenditure_item_id = PCDL.expenditure_item_id (+)
            AND PCDL.expenditure_item_id = XDA.source_distribution_id_num_1 (+)
            AND XDA.ae_header_id = XAL.ae_header_id (+)
            AND XDA.ae_line_num = XAL.ae_line_num (+)
            AND XAL.code_combination_id = gcc.code_combination_id (+)
            AND gcc.code_combination_id = c.code_combination_id (+)
            AND c.je_header_id = B.je_header_id (+)
            AND peia.project_id = ppab.project_id (+)
            AND ppab.project_id = ppat.project_id (+)
            AND B.LEDGER_ID = gll.LEDGER_ID (+)
            and PEIA.EXPENDITURE_ITEM_ID = ferc_data.TRANSACTION_IDG
            and xda.event_id = ferc_data.event_id
            and xda.ae_line_num = ferc_data.ae_line_num
            AND peia.expenditure_item_id = 31005
            AND B.name = '22-03-2024 Miscellaneous Cost'
            AND gll.name LIKE '%GAAP%';
